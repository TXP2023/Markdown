# A

![题面](/library/北师大2025-结营测.md.A_Xor.png)

**明显的 Xor 满足交换律， 故可以构造前缀和数组 $preXor$**

令对于 $i \in [1,n]$ , $preXor_i = preXor_{i-1} \oplus A_i$

特别的， 令 $preXor_0 = 0$

要求两个子区间不相交且顺序不重叠， 那么从不重叠可以知道 $r_1 < l_2$ 那么也就是说对于两个区间，我们只需要确定 $r_1 < l_2$ 就可以满足约束条件，对于 $l_1, r_2$ 是无所谓的。 那可以预处理出对于下标 $i$， 当下标 $i$ 作为 $r_1$ 或 $l_2$， 区间的最大异或和

令 $Lxor_i$ 为区间左端点为 $i$时 的区间的最大异或和， $Rxor_i$ 为区间右端点为 $i$时 的区间的最大异或和， 

那么问题转化为， 对于固定左(右)端点区间，如何求出区间最大异或和？

以左区间为例

我们知道 **Xor 可以构造前缀和**  ， 那么对与目标右端点 $i$ 要求出最大的 $j$ 使得区间异或和最大

$$Max\{A_j \oplus A_{j+1} \oplus ...  \oplus A_i\} $$

等价于

$$Max\{preXor_i \oplus preXor_{j-1}\}$$

对于每次枚举的 $i$,  **$preXor_i$是已知的**，就简化为了求最大的 $j \in [1, i] $ 使得 $preXor_{j-1}$ 最大， 可使用**01字典树**解决。

复杂度 $O(2*n*32)$ 

那么现在已知对于每个 $i$ 作为左(右)端点的区间的最大异或和， 现在可以枚举 $r_1, l_2$  作为端点, 复杂度 $O(n^2)$ , 太大了

如何优化？

记 $Xor(l, r) = preXor_r \oplus preXor_{l-1}$ 

对于右区间 $[l, r]$ 如果存在区间 $[l', r']$, 满足 $l < l'$ 且 $Xor(l, r) < Xor(l', r')$， 那么 $[l, r]$ 是没有意义的, 即对 $Lxor_l$ 的枚举是无意义的，那尝试记录从 $i$ 往左(右)的所有 $j$ 的最大区间异或和，为$BestLeft, BestRight$ , 那么也就是说对于两个区间

$$BestLeft_i = Max{BestLeft_{i-1}, Rxor_{i}}$$

$$BestRight_i = Max{BestRight_{i+1}, Lxor_{i}}$$

这一步可以在计算 $Lxor, Rxor$ 顺手干了， 复杂度$O(n)$

加下来就是枚举分割点 $i \in [1, n - 1]$

$$ans = Max{BestLeft[i] + BestRight[i + 1]}$$

问题就解决了