# P1485 火枪打怪

## 题目描述

现在 $n$ 个怪物， 从左至右数第 $i$ 只怪物的血量是 $m_i$， 当某只怪物的血量**小于** $0$ 时，它就死了，， 现在支持一种操作

* 将第 $i$ 个怪物的血量减少 $p$ ， 同时它左边的第 $j$ 个怪物 $(j<i)$，也会遭到 $\max(0, p - (i - j)^2)$ 的溅射伤害

求出一个最小的正整数 $p$，使 LXL 用 $k$ 发子弹且每发子弹的威力值为 $p$ 就可以消灭所有怪物。

## 输入格式

第一行，两个正整数 $n,k$。

第二行，$n$ 个正整数，第 $i$ 个正整数表示从左至右数第 $i$ 只怪物的血量 $m_i$。

## 输出格式

一个正整数，表示子弹的最小威力值 $p$。

## 说明/提示

对于 $30\%$ 的数据，$n\leq 300$。


对于 $100\%$ 的数据，$n\leq 5\times 10^5$，$k\leq 5\times 10^5$，$1\leq m_i\leq 10^{10}$。

# 思路

现在最大的威力就是 $2*10^{10}+1$ 尝试二分答案

那么对于某个 $mid$ 我们需要知道在每发子弹伤害为 $mid$ 时的是否可以消灭

首先，子弹只有左边存在溅射伤害，那么贪心的，我们就从最右边开始打。 

## 暴力30pts

暴力做法， 每次找到存活的最右边的怪物，打他，并产生溅射伤害。 2层循环实现。由于是使用 k 次，所以复杂度是 $O(k*n)$  

## 优化做法

我们记，直接对怪物 $x$ 造成的伤害为 $hit_x$

对于每次攻击怪物 $j$, 那么在 $p - (i - j)^2$ 大于0时， 怪物$j$会受到伤害。记 $max(j)$ 为最大的 $i$ 使得 $(i - j)^2 < p$, 那么可以对 怪物$j$ 造成溅射伤害的范围就是$[j + 1, max(j)]$

那么，当我们扫描到怪物 $j$ 时， 曾经对怪物 $j$ 造成的影响就是

$\Sigma_{k = j}^{max(j)} hit_k$

那么后缀和就可以维护了

